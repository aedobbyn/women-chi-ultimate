---
title: "Women in Chicago Ultimate Data Analysis"
author:
  name: Ladies of Chicago Ultimate
output: 
  html_document:
    keep_md: true
    toc: true
    theme: yeti
  github_document:
    toc: true
---

***

Outline
=====
* Munge
    + When possible, data was pulled straight from the raw data files and assigned codes in R. When not possible, data was pulled from hand-coded data source
    + Predictor variables: `age`, `where_live`, `team`, `currently_playing`, `how_long_play`, `start_playing`, `first_experience`, `team_type` (derived from team), `club_or_not` (derived from team type)
    + Response variables: `satis_amount_recode`, `satis_level_recode`, `conn_club`, `conn_recreational`, `conn_college`, `conn_youth`, `inclus_UC`, `inclus_college`, `inclus_women`, `inclus_mixed`, `satis_combined` (sum of satisfaction), `conn_combined` (sum of connectedness), `inclus_combined` (sum of inclusiveness), `overall` (sum of sums)  

* Plot
  + Focused on showing differences in the outcome variables depending on `team_type` as that was the best predictor of all the independent variables
  + A limitation of our data is that we only collected non-continuous data in both predictor and response variables. For that reason, all of the point plots are "jittered" (random noise introduced) so that they're a bit more visually interpretable.
    
* Model
  + Ordered Logistic/Probit Regressions for ordered categorical variables
  + OLS regression for summed categorical variables
  + Only looking at main effects for now, no interations
    
* Main takeaway
  + `team_type` was a significant predictor of general happiness with ultimate in Chicago. Nothing else was really significant.
  + Directionality: Non-club players feel less satisfied, connected, and included than club players
  + There isn't a significant difference between how happy/satisfied women's players and mixed players feel


***

![](./clinic.jpg) 

***

<br /><br /><br />

***

## Munge

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

source("./munge.R")
# source("./model.R")

```

* Categorize teams into 
  + a variable `team_type` with three levels: mixed, no_club, and womens
  + a variable `club_or_not` with two levels: club and not_club

* When the outcome variable is an ordered factor (e.g., "How satisfied are you with the AMOUNT of ultimate you are currently playing?")
  + Run an ordered probit regression with some number of predictor variables
predicting that single outcome variable

* Combine ordered categorical predictor variables into omnibus variables and treat them as continuous
  + The idea with summing ordinal response variables was to introduce more degrees of freedom into the outcome variable so that we could run a more standard linear regression rather than an ordered/logistic probit regression on each outcome variable. It hopefully gives us both more predictive power and a more holistic look at three main categories of response variable (satisfaction, connectedness, and inclusiveness)

Caveat: while directionality is constant across different variables (i.e., 1 always = bad or disagree or whatever), there are different levels for different variables that aren't necessarily comparable. They're ordered in
a way that makes the most sense, I think, but you could definitely argue for a different ordering. 

For example, for the question "How satisfied are you with the AMOUNT of ultimate you are currently playing?", is this the right ordering? 

Not satisfied: wants more < Not satisfied: wants less < Neutral < Other < Somewhat satisfied: wants more < Somewhat satisfied: wants less < Very satisfied      

`¯\_(ツ)_/¯`

<br /><br /><br />
      
***
## Some Visuals

**What people are playing by their team type**

Potential problem with the data colleged: many people took the survey after their seasons had ended so what they play in season != what they said they were currently playing (so maybe a reason to distrust `currently_playing`)

```{r}
currently_playing.hist <- ggplot(data = na.omit(all)) +
  geom_bar(aes(currently_playing)) + 
  theme(axis.text.x = element_text(angle = 60, hjust = 1))
currently_playing.hist
```

<br>

Satisfaction with amount playing faceted by team type
```{r}
ggplot(na.omit(all)) + 
  geom_bar(aes(x = satis_amount_recode,
               y = (..count..)/sum(..count..),
               position = "dodge")) +
  facet_grid(~ team_type) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))
```

<br>

Overall satisfaction broken down by team type
```{r}
overall.team_type <- ggplot(data = all) +
  geom_bar(aes(overall, fill = team_type), position = "dodge") 
overall.team_type
```

<br>

Jittered age (ordinal) vs. overall happiness w/ boxplot of overall superimposed
```{r overall.team_type, echo = FALSE, warning=FALSE, message=FALSE}

qplot(age, overall, data = all) +
  geom_jitter() +
  geom_boxplot(alpha = 0.3)
```


#### Drilling down into team_type

<br>

How long have non-Chicago club players been playing?
```{r}
no_club.how_long_play <- 
  ggplot(data = na.omit(all[all$team_type == "no_club", ])) +
  geom_bar(aes(team, fill = how_long_play), position = "fill") + 
  theme(axis.text.x = element_text(angle = 60, hjust = 1))
no_club.how_long_play
```

Womens: age predicting overall happiness

(Careful of the nemesis outlier (only Nemesis player with `age`==4))
```{r}
ggplot(all[all$team_type == "womens", ],
       aes(x = as.numeric(age), y = overall, colour = team)) + 
  geom_jitter() +
  geom_smooth(method = "lm", se = FALSE)
```

<br>

Mixed: how long they've played predicting overall satisfaction
```{r}
ggplot(all[all$team_type == "mixed", ],
       aes(x = as.numeric(how_long_play), y = overall, colour = team)) + 
  geom_jitter() +
  geom_smooth(method = "lm", se = FALSE)
```


<br><br>

### Satisfaction Amount by Team Type
Focusing on amount rather than level because the model showed `team_type` predicting satisfaction amount but not level. (In other words, what kind of team you're on has an effect on whether you're satisfied with the amount you're playing or not.)

```{r}
ggplot(na.omit(all[all$team_type=="womens", ])) + 
  geom_bar(aes(x = satis_amount_recode, y = (..count..)/sum(..count..),
               position = "fill")) +
  labs(title = "Satisfaction with Amount of Play: Womens") +
  scale_y_continuous(labels = scales::percent) +
  scale_x_discrete(drop=FALSE) +     # don't drop unused levels
  theme(axis.text.x = element_text(angle = 60, hjust = 1))
```

```{r}
ggplot(na.omit(all[all$team_type=="mixed", ])) + 
  geom_bar(aes(x = satis_amount_recode, y = (..count..)/sum(..count..),
               position = "fill")) +
  labs(title = "Satisfaction with Amount of Play: Mixed") +
  scale_y_continuous(labels = scales::percent) +
  scale_x_discrete(drop=FALSE) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))
```

```{r}
ggplot(na.omit(all[all$team_type=="no_club", ])) + 
  geom_bar(aes(x = satis_amount_recode, y = (..count..)/sum(..count..),
               position = "fill")) +
  labs(title = "Satisfaction with Amount of Play: Non-Club Players") +
  scale_y_continuous(labels = scales::percent) +
  scale_x_discrete(drop=FALSE) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))


```

<br /><br /><br />

***
## Models

Omnibus model with all predictors predicting the overall measure
```{r m.big, echo=FALSE}

m.big <- lm(overall ~ 
            age + team_type + 
            currently_playing + 
            how_long_play + 
            start_playing +
            where_live,
            data = all)
```

``` {r}
summary(m.big)
```

What about the effect of team type on just satisfaction level?  

* Make two models, one with `team_type` as a predictor and one without
```{r, echo=FALSE}
library(ordinal)

# ------- with team_type and age predicting satis_level_recode --------
m.satis_level_team_t <- clm(satis_level_recode ~ team_type + age,
                link = "probit",
                       data = all)

# take out team type
m.satis_level_no.team_t <- clm(satis_level_recode ~ age,
                   link = "probit",
                       data = all)
```

<br> 

* Compare the performance of the models in predicting satisfaction level
* The model with team type does't predict satisfaction level better than the one without it (p = 0.6361). 
* So team_type is not a significant predictor of satisfaciton with the level of ultimate you're playing.
```{r}
anova(m.satis_level_team_t, m.satis_level_no.team_t)
```

<br> 

What about satisfaction with the amount of ultimate you're playing?

* Same procdure.

```{r }
# ------- with team_type and age predicting satis_amount_recode ------- 
m.sais_amount_team_t <- clm(satis_amount_recode ~ team_type + age,
                link = "probit",
                data = all)
m.sais_amount_no.team_t <- clm(satis_amount_recode ~ age,
                   link = "probit",
                   data = all)
```

<br>

Model with team type *does* predict satisfaction level better than the one without it (p = 0.0072)
```{r}
anova(m.sais_amount_team_t, m.sais_amount_no.team_t)
```

<br>

Okay so there's a there there with `team_type`. So does `team_type` pedict overall satisfaction, inclusion, connection, and all of the above?

<br>
**Do womens and mixed players have significantly higher overall satisfaction and inclusion than non-club players?**

<br>

Satisfaction: yes (p = 0.0252)
```{r}
m.satis_combined.team_type <- lm(satis_combined ~ team_type,
                       data = all)
summary(m.satis_combined.team_type)
```

Connection: yes (p = 1.17e-07)
```{r}
m.conn_combined.team_type <- lm(conn_combined ~ team_type,
                                 data = all)
summary(m.conn_combined.team_type)
```

Inclusion: yes (p = 0.00245)
```{r}
m.inclus_combined.team_type <- lm(inclus_combined ~ team_type,
                                 data = all)
summary(m.inclus_combined.team_type)
```

Overally: yes (p = 2.82e-07)
```{r}
m.overall.team_type <- lm(overall ~ team_type,
                                  data = all)
summary(m.overall.team_type)
```

<br>

Is there a significant difference in combined satisfaction and inclusion scores between womens and mixed players?
No, p = 0.841

```{r}
womens_and_mixed.m.overall.team_type <- lm(overall ~ team_type,
                                            data = all[all$team_type %in% c("womens", "mixed"), ])
summary(womens_and_mixed.m.overall.team_type)

```



<br><br><br>

