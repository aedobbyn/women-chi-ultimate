---
title: "Women in Chicago Ultimate Data Analysis"
author:
  name: Ladies of Chicago Ultimate
output: 
  html_document:
    keep_md: true
    toc: true
    theme: yeti
  github_document:
    toc: true
---

***

Outline
=====
* About:
    + Survey distributed by Steph Landry
* Models:
    + Ordered Logistic/Probit Regressions for ordered categorical variables
    + OLS regression for summed categorical variables
* Plots:
    + Many

***

![](./clinic.jpg) 

***

<br /><br /><br />

## Munge

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

source("./munge.R")

```

* Break teams into 
+ a variable `team_type` with three levels: mixed, no_club, and womens
+ a variable `club_or_not` with two levels: club and not_club

* When the outcome variable is an ordered factor (e.g., "How satisfied are you with the AMOUNT of ultimate you are currently playing?")
+ Run an ordered probit regressions with some number of predictor variables
predicting that single outcome variable

* Combine categorical variables into omnibus variables  

  + These omnibus variables are more continuous so treat them as 
  + Caveat: while directionality is constant across different variables (i.e., 1 always = bad, disagree), there are different levels for different variables that aren't necessarily comparable. They're ordered in
a way that makes the most sense, I think, but you could definitely argue for a different ordering. For example, for the question "How satisfied are you with the AMOUNT of ultimate you are currently playing?", is this the right ordering? 

"Not satisfied: wants more" < "Not satisfied: wants less" < "Neutral" < "Other" < "Somewhat satisfied: wants more" < "Somewhat satisfied: wants less" < "Very satisfied"      

¯\_(ツ)_/¯

          


## Some Visuals

```{r overall.team_type, echo = FALSE}

# jittered age (ordinal) vs. overall w/ boxplot superimposed
qplot(age, overall, data = all) +
  geom_jitter() +
  geom_boxplot(alpha = 0.3)


overall.team_type <- ggplot(data = all) +
  geom_bar(aes(overall, fill = team_type), position = "dodge") 
overall.team_type


womens_teams.how_long_play <- 
  ggplot(data = na.omit(all[all$team_type == "womens", ])) +
  geom_bar(aes(team, fill = how_long_play), position = "fill") + 
  theme(axis.text.x = element_text(angle = 60, hjust = 1))
womens_teams.how_long_play



# team_type=='womens'
ggplot(na.omit(all[all$team_type=="womens", ])) + 
  geom_bar(aes(x = satis_amount_recode, y = (..count..)/sum(..count..),
               position = "fill")) +
  labs(title = "Satisfaction with Amount of Play: Womens") +
  scale_y_continuous(labels = scales::percent) +
  scale_x_discrete(drop=FALSE) +     # don't drop unused levels
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

# team_type=='mixed'
ggplot(na.omit(all[all$team_type=="mixed", ])) + 
  geom_bar(aes(x = satis_amount_recode, y = (..count..)/sum(..count..),
               position = "fill")) +
  labs(title = "Satisfaction with Amount of Play: Mixed") +
  scale_y_continuous(labels = scales::percent) +
  scale_x_discrete(drop=FALSE) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

# team_type=='no_club'
ggplot(na.omit(all[all$team_type=="no_club", ])) + 
  geom_bar(aes(x = satis_amount_recode, y = (..count..)/sum(..count..),
               position = "fill")) +
  labs(title = "Satisfaction with Amount of Play: Non-Chicago Club Players") +
  scale_y_continuous(labels = scales::percent) +
  scale_x_discrete(drop=FALSE) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))


```


```{r model}

# what is the effect of all non-ordinal predictors on overall 
m.big <- lm(overall ~ 
              age + team + 
              currently_playing + how_long_play, 
            # start_playing,
            data = all)
summary(m.big)

# # ordinal probit: does age predict team_type?
# m.team_type.age <- MASS::polr(team_type ~ age, 
#                               data = all, 
#                               Hess = TRUE)
# summary(m.team_type.age)



library(ordinal)

# ------- with team_type and age predicting satis_level_recode --------
m.team_t <- clm(satis_level_recode ~ team_type + age,
                link = "probit",
                       data = all)

# take out team type
m.no.team_t <- clm(satis_level_recode ~ age,
                   link = "probit",
                       data = all)

# compare models
anova(m.team_t, m.no.team_t)
# model with team type does't predict satisfaction level better than the one without it
# probit and logit linking functions yield roughly the same chisq


# ------- with team_type and age predicting satis_amount_recode ------- 
m.team_t <- clm(satis_amount_recode ~ team_type + age,
                link = "probit",
                data = all)
m.no.team_t <- clm(satis_amount_recode ~ age,
                   link = "probit",
                   data = all)
anova(m.team_t, m.no.team_t)
# model with team type DOES predict satisfaction level better than the one without it (p = 0.0072)


# ------






# ------------------ by team_type ---------------------
# predict overall satisfaction, inclusion, and both from team type
# no_club is reference level, coded as 1
# mixed coded as 2
# womens coded as 3

# both womens and mixed players have overall higher satisfaction and inclusion than non-club players

# p = 0.0252
m.satis_combined.team_type <- lm(satis_combined ~ team_type,
                       data = all)
summary(m.satis_combined.team_type)

# p = 1.17e-07
m.conn_combined.team_type <- lm(conn_combined ~ team_type,
                                 data = all)
summary(m.conn_combined.team_type)

# p = 0.00245
m.inclus_combined.team_type <- lm(inclus_combined ~ team_type,
                                 data = all)
summary(m.inclus_combined.team_type)

# p = 2.82e-07
m.overall.team_type <- lm(overall ~ team_type,
                                  data = all)
summary(m.overall.team_type)


# is there a signif difference in combined satisfaction and inclusion scores between womens and mixed players?
# no, p = 0.841
womens_and_mixed.m.overall.team_type <- lm(overall ~ team_type,
                                            data = all[all$team_type %in% c("womens", "mixed"), ])
summary(womens_and_mixed.m.overall.team_type)

```

